<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DustBusters Customer Feedback</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');
    
    body {
      font-family: 'Inter', sans-serif;
      background: linear-gradient(135deg, #0ea5e9 0%, #2563eb 100%);
      min-height: 100vh;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    /* Animated gradient background */
    @keyframes gradient {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(-45deg, #0ea5e9, #2563eb, #3b82f6, #06b6d4);
      background-size: 400% 400%;
      animation: gradient 15s ease infinite;
      z-index: -1;
    }

    /* Card entrance animation */
    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .animate-slide-in {
      animation: slideIn 0.6s ease-out;
    }

    /* Star rating styles */
    .star-rating button {
      transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
      color: #cbd5e1;
      cursor: pointer;
      filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.1));
    }

    .star-rating:not(.pointer-events-none) button:hover {
      transform: scale(1.2) rotate(-5deg);
      filter: drop-shadow(0 4px 8px rgba(250, 204, 21, 0.4));
    }

    .star-rating button.hovered {
      color: #fde047;
    }

    .star-rating button.selected {
      color: #facc15;
      transform: scale(1.1);
      filter: drop-shadow(0 4px 12px rgba(250, 204, 21, 0.5));
    }

    /* Input focus styles */
    input:focus, textarea:focus {
      transform: translateY(-2px);
      box-shadow: 0 8px 16px rgba(37, 99, 235, 0.15);
    }

    /* Button hover effect */
    button[type="submit"]:hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 24px rgba(37, 99, 235, 0.4);
    }

    /* Smooth transitions between views */
    .view-transition {
      transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out;
    }

    .view-transition.hidden {
      opacity: 0;
      transform: scale(0.95);
      pointer-events: none;
    }

    /* Logo glow effect */
    .logo-glow {
      box-shadow: 0 8px 32px rgba(37, 99, 235, 0.3);
      transition: box-shadow 0.3s ease;
    }

    .logo-glow:hover {
      box-shadow: 0 12px 48px rgba(37, 99, 235, 0.5);
    }

    /* Pulse animation for submit button */
    @keyframes pulse {
      0%, 100% {
        opacity: 1;
      }
      50% {
        opacity: 0.8;
      }
    }

    .animate-pulse-slow {
      animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
    }
  </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">

  <!-- Main Card Container -->
  <div class="w-full max-w-lg bg-white/95 backdrop-blur-sm rounded-3xl shadow-2xl border border-white/20 p-8 sm:p-12 animate-slide-in">

    <!-- View 1: Star Rating -->
    <div id="view-star-rating" class="view-transition">
      <!-- Logo -->
      <div class="flex justify-center mb-8">
        <div class="bg-gradient-to-br from-blue-600 to-cyan-600 rounded-2xl p-5 logo-glow inline-block">
          <img src="https://lh3.googleusercontent.com/d/1_eFG61720UHdHtgzAScVaA083rVBylyY" 
               alt="DustBusters Cleaners Logo" 
               class="w-44 h-auto"
               onerror="this.src='https://placehold.co/176x44/2563eb/ffffff?text=DustBusters'; this.onerror=null;">
        </div>
      </div>

      <!-- Header -->
      <div class="text-center mb-10">
        <h1 class="text-4xl font-bold bg-gradient-to-r from-blue-600 to-cyan-600 bg-clip-text text-transparent mb-4">
          How was your experience?
        </h1>
        <p class="text-lg text-gray-600">
          Your feedback helps us serve you better âœ¨
        </p>
      </div>

      <!-- Star Rating Container -->
      <div id="starContainer" class="star-rating flex justify-center space-x-3 mb-8" data-rating="0">
        <button type="button" data-value="1" class="text-6xl sm:text-7xl focus:outline-none" aria-label="1 star">&#9733;</button>
        <button type="button" data-value="2" class="text-6xl sm:text-7xl focus:outline-none" aria-label="2 stars">&#9733;</button>
        <button type="button" data-value="3" class="text-6xl sm:text-7xl focus:outline-none" aria-label="3 stars">&#9733;</button>
        <button type="button" data-value="4" class="text-6xl sm:text-7xl focus:outline-none" aria-label="4 stars">&#9733;</button>
        <button type="button" data-value="5" class="text-6xl sm:text-7xl focus:outline-none" aria-label="5 stars">&#9733;</button>
      </div>

      <input type="hidden" id="starRating" value="0">
      
      <!-- Feedback Message -->
      <div id="ratingMessage" class="text-center font-semibold text-lg mt-8 h-8 transition-all"></div>
    </div>

    <!-- View 2: Internal Feedback Form -->
    <div id="view-internal-feedback" class="view-transition hidden">
      <!-- Logo -->
      <div class="flex justify-center mb-8">
        <div class="bg-gradient-to-br from-blue-600 to-cyan-600 rounded-2xl p-5 logo-glow inline-block">
          <img src="https://lh3.googleusercontent.com/d/1_eFG61720UHdHtgzAScVaA083rVBylyY" 
               alt="DustBusters Cleaners Logo" 
               class="w-44 h-auto"
               onerror="this.src='https://placehold.co/176x44/2563eb/ffffff?text=DustBusters'; this.onerror=null;">
        </div>
      </div>

      <!-- Header -->
      <div class="text-center mb-8">
        <h1 class="text-3xl font-bold bg-gradient-to-r from-blue-600 to-cyan-600 bg-clip-text text-transparent mb-3">
          We appreciate your honesty ðŸ’¬
        </h1>
        <p class="text-base text-gray-600">
          Help us improve to make your next experience 5 stars!
        </p>
      </div>

      <!-- Feedback Form -->
      <form id="internalForm" action="https://formsubmit.co/admin@dustbusterscleaners.com" method="POST" class="space-y-5">
        <input type="hidden" name="_subject" value="New Feedback from DustBusters Customer">
        <input type="hidden" id="rating-for-email" name="star_rating" value="">
        <input type="hidden" name="_next" id="next-url" value="">
        <input type="hidden" name="_captcha" value="false">
        <input type="hidden" name="_template" value="table">
        <input type="text" name="_honey" style="display:none" tabindex="-1" autocomplete="off">

        <!-- Name Fields -->
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
          <div>
            <label for="firstName" class="block text-sm font-semibold text-gray-700 mb-2">First Name</label>
            <input type="text" 
                   id="firstName" 
                   name="first_name" 
                   class="w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 bg-gray-50 transition-all outline-none" 
                   placeholder="John" 
                   required>
          </div>
          <div>
            <label for="lastName" class="block text-sm font-semibold text-gray-700 mb-2">Last Name</label>
            <input type="text" 
                   id="lastName" 
                   name="last_name" 
                   class="w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 bg-gray-50 transition-all outline-none" 
                   placeholder="Doe" 
                   required>
          </div>
        </div>

        <!-- Feedback Textarea -->
        <div>
          <label for="feedbackText" class="block text-sm font-semibold text-gray-700 mb-2">Your Feedback</label>
          <textarea id="feedbackText" 
                    name="feedback" 
                    rows="5" 
                    class="w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 bg-gray-50 transition-all outline-none resize-none" 
                    placeholder="What could we do better?"
                    required></textarea>
        </div>

        <!-- Email Field -->
        <div>
          <label for="email" class="block text-sm font-semibold text-gray-700 mb-2">
            Your Email <span class="text-gray-400 font-normal">(Optional)</span>
          </label>
          <input type="email" 
                 id="email" 
                 name="_replyto" 
                 class="w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 bg-gray-50 transition-all outline-none" 
                 placeholder="you@example.com">
        </div>

        <!-- Submit Button -->
        <button type="submit" 
                id="internalSubmitBtn" 
                class="w-full py-4 px-6 rounded-xl text-white font-bold text-lg bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-700 hover:to-cyan-700 focus:outline-none focus:ring-4 focus:ring-blue-300 transition-all shadow-lg">
          Submit Feedback
        </button>
      </form>
    </div>

    <!-- View 3: Thank You Message -->
    <div id="view-final-thanks" class="view-transition hidden">
      <!-- Logo -->
      <div class="flex justify-center mb-8">
        <div class="bg-gradient-to-br from-blue-600 to-cyan-600 rounded-2xl p-5 logo-glow inline-block">
          <img src="https://lh3.googleusercontent.com/d/1_eFG61720UHdHtgzAScVaA083rVBylyY" 
               alt="DustBusters Cleaners Logo" 
               class="w-44 h-auto"
               onerror="this.src='https://placehold.co/176x44/2563eb/ffffff?text=DustBusters'; this.onerror=null;">
        </div>
      </div>

      <!-- Thank You Message -->
      <div class="text-center mb-10">
        <div class="text-7xl mb-6 animate-bounce">ðŸŽ‰</div>
        <h1 class="text-4xl font-bold bg-gradient-to-r from-blue-600 to-cyan-600 bg-clip-text text-transparent mb-4">
          Thank You!
        </h1>
        <p class="text-lg text-gray-600">
          We've received your feedback and will use it to improve our service.
        </p>
      </div>

      <!-- Start Over Button -->
      <button id="start-over-btn" 
              class="w-full py-4 px-6 rounded-xl font-bold text-lg text-blue-700 bg-blue-50 hover:bg-blue-100 border-2 border-blue-200 focus:outline-none focus:ring-4 focus:ring-blue-300 transition-all">
        Submit Another Review
      </button>
    </div>
  </div>

  <script>
    // ===== CONFIGURATION =====
    const YOUR_GOOGLE_REVIEW_LINK = "https://g.page/r/CVfMkbfdfFy_EAI/review";
    
    // Set the redirect URL to your GitHub Pages hosted form
    const currentUrl = "https://admin-dustbusters.github.io/feedback/feedback.html";

    // ===== ELEMENT SELECTORS =====
    const starView = document.getElementById('view-star-rating');
    const feedbackView = document.getElementById('view-internal-feedback');
    const thanksView = document.getElementById('view-final-thanks');
    const starContainer = document.getElementById('starContainer');
    const starRatingInput = document.getElementById('starRating');
    const ratingMessage = document.getElementById('ratingMessage');
    const stars = starContainer.querySelectorAll('button');
    const internalForm = document.getElementById('internalForm');
    const startOverBtn = document.getElementById('start-over-btn');

    // ===== FUNCTIONS =====

    /**
     * Sets the permanent clicked rating
     */
    function setClickedRating(rating) {
      starRatingInput.value = rating;
      starContainer.setAttribute('data-rating', rating);
      stars.forEach(star => {
        star.classList.remove('hovered');
        star.classList.toggle('selected', parseInt(star.dataset.value) <= rating);
      });
    }

    /**
     * Sets the hover rating (temporary preview)
     */
    function setHoverRating(rating) {
      stars.forEach(star => {
        star.classList.toggle('hovered', parseInt(star.dataset.value) <= rating);
      });
    }

    /**
     * Resets stars to the clicked rating
     */
    function resetStarsToClickedRating() {
      const clickedRating = parseInt(starContainer.getAttribute('data-rating'));
      stars.forEach(star => {
        star.classList.remove('hovered');
        star.classList.toggle('selected', parseInt(star.dataset.value) <= clickedRating);
      });
    }

    /**
     * Shows the internal feedback form
     */
    function showInternalFormWithRating(rating) {
      document.getElementById('rating-for-email').value = String(rating);
      // Set the redirect URL to come back to this page with ?submitted=true
      document.getElementById('next-url').value = currentUrl + '?submitted=true';
      starView.classList.add('hidden');
      feedbackView.classList.remove('hidden');
    }

    // ===== EVENT LISTENERS =====

    // Star Rating Click Logic
    stars.forEach(star => {
      star.addEventListener('click', (e) => {
        e.preventDefault();
        if (starContainer.classList.contains('pointer-events-none')) return;

        const rating = parseInt(star.dataset.value);
        setClickedRating(rating);
        starContainer.classList.add('pointer-events-none');

        if (rating === 5) {
          // 5-Star: Redirect to Google Reviews
          ratingMessage.textContent = "ðŸŒŸ Thank you! Redirecting to Google...";
          ratingMessage.classList.add('text-green-600');
          
          setTimeout(() => {
            window.open(YOUR_GOOGLE_REVIEW_LINK, '_blank');
            starContainer.classList.remove('pointer-events-none');
            setClickedRating(0);
            ratingMessage.textContent = "";
            ratingMessage.classList.remove('text-green-600');
          }, 1500);

        } else {
          // 1-4 Stars: Show feedback form
          ratingMessage.textContent = "We're sorry to hear that. Let us know how we can improve.";
          ratingMessage.classList.add('text-orange-600');
          
          setTimeout(() => {
            showInternalFormWithRating(rating);
            ratingMessage.textContent = "";
            ratingMessage.classList.remove('text-orange-600');
          }, 1200);
        }
      });

      // Star Hover Effect
      star.addEventListener('mouseover', () => {
        if (starContainer.classList.contains('pointer-events-none')) return;
        const hoverRating = parseInt(star.dataset.value);
        setHoverRating(hoverRating);
      });
    });

    // Reset stars when mouse leaves container
    starContainer.addEventListener('mouseleave', () => {
      if (starContainer.classList.contains('pointer-events-none')) return;
      resetStarsToClickedRating();
    });

    // Form submission - Let it submit normally (no AJAX)
    // FormSubmit will handle the submission and redirect back to ?submitted=true
    
    // Start Over Button
    if (startOverBtn) {
      startOverBtn.addEventListener('click', () => {
        thanksView.classList.add('hidden');
        starView.classList.remove('hidden');
        feedbackView.classList.add('hidden');
        starContainer.classList.remove('pointer-events-none');
        setClickedRating(0);

        // Clear URL query parameters
        if (window.history.replaceState) {
          window.history.replaceState(null, null, window.location.pathname);
        }
      });
    }

    // ===== INITIALIZATION =====
    // Check for ?submitted=true in URL to show "Thank You" page
    const urlParams = new URLSearchParams(window.location.search);
    if (urlParams.has('submitted')) {
      starView.classList.add('hidden');
      feedbackView.classList.add('hidden');
      thanksView.classList.remove('hidden');
    }
  </script>
</body>
</html>
